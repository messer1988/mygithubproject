apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "nginx-app.fullname" . }}-site
data:
  index.html: |
    <!DOCTYPE html>
    <html lang="ru">
    <head>
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1" />
      <title>DevOps Helper</title>
      <style>
        body{
          font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
          background:#0f172a; color:#e5e7eb; margin:0;
        }
        header{
          background:#020617; padding:22px 16px; text-align:center;
          border-bottom:1px solid rgba(148,163,184,0.15);
        }
        header h1{margin:0; font-size:28px;}
        header p{margin:8px 0 0; opacity:.8}
        main{padding:26px 16px 40px; max-width:1100px; margin:auto;}
        .topbar{display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:16px; flex-wrap:wrap;}
        .hint{opacity:.75; font-size:14px}
        button{
          background:#1f2937; color:#e5e7eb; border:1px solid rgba(148,163,184,0.25);
          border-radius:10px; padding:10px 12px; cursor:pointer;
        }
        button:hover{background:#111827}
        .grid{
          display:grid; grid-template-columns:repeat(auto-fit,minmax(260px,1fr)); gap:16px;
        }
        .card{
          background:#020617; padding:16px; border-radius:14px;
          border:1px solid rgba(148,163,184,0.15);
        }
        .card h3{margin:0 0 10px}
        .card p{margin:8px 0; opacity:.92}
        .badge{
          font-weight:800; padding:6px 10px; border-radius:999px;
          border:1px solid rgba(148,163,184,0.25); min-width:72px; text-align:center;
        }
        .ok{color:#22c55e; border-color:rgba(34,197,94,.35); background:rgba(34,197,94,.10)}
        .bad{color:#ef4444; border-color:rgba(239,68,68,.35); background:rgba(239,68,68,.10)}
        .wait{color:#eab308; border-color:rgba(234,179,8,.35); background:rgba(234,179,8,.10)}
        .row{display:flex; align-items:center; justify-content:space-between; gap:10px}
        code{
          background:rgba(148,163,184,0.12); padding:2px 6px; border-radius:8px;
          font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;
          font-size:12.5px;
        }
        pre{
          margin:10px 0 0; padding:10px 12px; border-radius:12px;
          background:rgba(148,163,184,0.08); border:1px solid rgba(148,163,184,0.15);
          overflow:auto;
          font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;
          font-size:12.5px;
          line-height:1.4;
          white-space:pre;
        }
        .cmd{position:relative}
        .copy{
          position:absolute; top:10px; right:10px;
          font-size:12px; padding:6px 9px; border-radius:10px;
          background:#111827;
        }
        .copy:active{transform:translateY(1px)}
        .sectionTitle{
          margin:18px 0 10px; opacity:.85; font-size:13px; text-transform:uppercase; letter-spacing:.08em;
        }
        footer{
          text-align:center; padding:18px 16px; opacity:.65;
          border-top:1px solid rgba(148,163,184,0.15); background:#020617;
        }
        .mini{font-size:12.5px; opacity:.8}
      </style>
    </head>
    <body>
      <header>
        <h1>üöÄ DevOps Helper</h1>
        <p>Kubernetes ‚Ä¢ Helm ‚Ä¢ Istio ‚Ä¢ CI/CD ‚Ä¢ Cheatsheet</p>
      </header>

      <main>
        <div class="topbar">
          <div class="hint">Health from <code>/health/*</code>. –ö–æ–º–∞–Ω–¥—ã –Ω–∏–∂–µ ‚Äî –∫–æ–ø–∏—Ä—É–π –∏ –∑–∞–ø—É—Å–∫–∞–π –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ.</div>
          <button onclick="refreshAll()">Refresh health</button>
        </div>

        <div class="grid">
          <div class="card">
            <h3>‚úÖ Health checks</h3>
            <div class="row"><span><code>/health/live</code></span><span id="live" class="badge wait">‚Ä¶</span></div>
            <div class="row" style="margin-top:10px;"><span><code>/health/ready</code></span><span id="ready" class="badge wait">‚Ä¶</span></div>
            <div class="row" style="margin-top:10px;"><span><code>/health/startup</code></span><span id="startup" class="badge wait">‚Ä¶</span></div>
            <p class="mini" id="last">Last check: -</p>
          </div>

          <div class="card">
            <h3>üîé Quick status</h3>
            <p class="mini">–°–∞–º–æ–µ –ø–æ–ª–µ–∑–Ω–æ–µ ‚Äú—Å—Ä–∞–∑—É –ø–æ–Ω—è—Ç—å —á—Ç–æ –∂–∏–≤–æ‚Äù:</p>

            <div class="cmd">
              <button class="copy" onclick="copyCmd('c1')">Copy</button>
              <pre id="c1">kubectl get nodes -o wide</pre>
            </div>

            <div class="cmd">
              <button class="copy" onclick="copyCmd('c2')">Copy</button>
              <pre id="c2">kubectl get pods -A -o wide</pre>
            </div>

            <div class="cmd">
              <button class="copy" onclick="copyCmd('c3')">Copy</button>
              <pre id="c3">kubectl -n default get deploy,po,svc,ep -o wide</pre>
            </div>
          </div>

          <div class="card">
            <h3>üß≠ Minikube / Cluster bring-up</h3>
            <p class="mini">–ü–æ–¥–Ω—è—Ç—å/–ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–ª–∞—Å—Ç–µ—Ä:</p>

            <div class="cmd">
              <button class="copy" onclick="copyCmd('c4')">Copy</button>
              <pre id="c4">minikube start --driver=docker</pre>
            </div>

            <div class="cmd">
              <button class="copy" onclick="copyCmd('c5')">Copy</button>
              <pre id="c5">minikube status && kubectl cluster-info</pre>